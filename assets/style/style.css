:root {
  /* --bgcolor: #ffe6f2; */
  /* --fgcolor: #0042d0; */
  --bgcolor: white;
  --fgcolor: black;

  --termcolor: #424242ca;
  --gap: 1rem;
}

/*******************************************************************************
._ __  __ _(_)_ _   | |__ _ _  _ ___ _  _| |_  This is a really basic layout,
| '  \/ _` | | ' \  | / _` | || / _ \ || |  _| working from browser styles it
|_|_|_\__,_|_|_||_| |_\__,_|\_, \___/\_,_|\__| just sets fonts and placement...
*****************************|__/**********************************************/

/* Following https://www.a11yproject.com/posts/how-to-hide-content/  */
.visually-hidden {
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
  height: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
  width: 1px;
}

* {
  box-sizing: border-box;
}

[id] {
  scroll-margin-top: 3rem;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  padding: 4rem 1rem;
  /* Thanks to https://modernfontstacks.com/ */
  font-family: 'Iowan Old Style', 'Palatino Linotype', 'URW Palladio L', P052, serif;
  font-weight: normal;
}

header,
footer {
  display: contents;
}

header > a {
  display: block;
  position: fixed;
  top: 1rem;
  left: 1rem;
  width: 4rem;
  z-index: calc(infinity);
  animation: breathe 5s ease-out infinite normal;
}
@keyframes breathe {
  0% {
    transform: scale(0.96);
  }
  25% {
    transform: scale(1);
  }
  60% {
    transform: scale(0.96);
  }
  100% {
    transform: scale(0.96);
  }
}
header > a div {
  animation: rotateX linear;
  animation-timeline: scroll(root y);
}
header > a svg {
  background: red;
  fill: white;
  animation: rotateY linear;
  animation-timeline: scroll(root x);
}
@keyframes rotateX {
  0% {
    transform: rotateX(0deg);
  }
  100% {
    transform: rotateX(7560deg);
  }
}
@keyframes rotateY {
  0% {
    transform: rotateY(0deg);
  }
  100% {
    transform: rotateY(7560deg);
  }
}

header ul {
  position: fixed;
  padding: 0;
  top: 0.5rem;
  right: 1rem;
  display: flex;
  flex-flow: row nowrap;
  gap: var(--gap);
  list-style: none;
  max-width: calc(100vw - 7rem);
  overflow: hidden;
  z-index: 99;
}

footer p {
  position: fixed;
  bottom: 1rem;
  left: 1rem;
  margin: 0;
}

footer p span {
  display: inline-block;
  transform-origin: center;
  transform: rotate(180deg);
  margin-right: 0.1rem;
}

main {
  position: relative;
}

article ol,
article ul {
  padding: 0;
  list-style-position: inside;
}
article sup {
  line-height: 0.6rem;
  font-size: 0.8rem;
}
article sup a,
article .footnotes a {
  text-decoration: none;
}
article hr {
  margin: 1rem 0;
  border: 0;
  height: 1px;
  width: 7rem;
  background: var(--fgcolor);
}

div#grid {
  display: none;
  position: absolute;
  pointer-events: none;
  z-index: -1;
  width: 100%;
  height: 100%;
  border: 1px solid hotpink;
  background: repeating-linear-gradient(
      to right,
      transparent,
      transparent calc(var(--cellsize) - 1px),
      hotpink var(--cellsize),
      transparent calc(var(--cellsize) + 1px),
      transparent calc(var(--cellsize) + var(--gapsize) - 2px),
      hotpink calc(var(--cellsize) + var(--gapsize) - 1px),
      transparent calc(var(--cellsize) + var(--gapsize))
    ),
    repeating-linear-gradient(
      to bottom,
      transparent,
      transparent calc(var(--cellsize) - 1px),
      hotpink var(--cellsize),
      transparent calc(var(--cellsize) + 1px),
      transparent calc(var(--cellsize) + var(--gapsize) - 2px),
      hotpink calc(var(--cellsize) + var(--gapsize) - 1px),
      transparent calc(var(--cellsize) + var(--gapsize))
    );
}

@media (min-width: 30rem) {
  main {
    --cellsize: 15rem;
    --gapsize: 2rem;

    display: grid;
    place-items: stretch;
    justify-content: stretch;

    width: calc(42 * var(--cellsize) + 41 * var(--gapsize));
    grid-template-columns: repeat(42, var(--cellsize));
    grid-template-rows: repeat(42, var(--cellsize));
    gap: var(--gapsize);
  }
  div#grid {
    display: block;
  }
}

@media (min-width: 60rem) {
  main {
    --cellsize: 20rem;
    --gapsize: 5rem;
  }
}

/*******************************************************************************
| _ \ |__ _ __ ___ _ __  ___ _ _| |_ 
|  _/ / _` / _/ -_) '  \/ -_) ' \  _|
|_| |_\__,_\__\___|_|_|_\___|_||_\__|
*******************************************************************************/

#welcome {
  grid-column: 1 / 2;
  grid-row: 1 / 2;
}

#window {
  grid-column: 1 / 2;
  grid-row: 2 / 4;
}

#garden {
  grid-column: 2 / span 2;
  grid-row: 2 / span 2;
}

#penrose {
  grid-column: 2 / 3;
  grid-row: 1 / 2;
}

#incomprehensible {
  grid-column: 15 / 16;
  grid-row: 25 / 26;
}

#reutersvard {
  grid-column: 2 / 3;
  grid-row: 1 / 2;
}

#desire {
  grid-column: 16 / span 2;
  grid-row: 2 / span 3;
  columns: auto var(--cellsize);
}

#manpage {
  grid-column: 40 / span 2;
  grid-row: 3;
}

#diwhy {
  grid-column: 7 / span 2;
  grid-row: 14 / span 2;

  display: flex;
  flex-flow: column nowrap;
  align-items: stretch;
}

#zen {
  grid-column: 2 / 3;
  grid-row: 40 / 41;
}

#heap {
  grid-column: 41 / span 2;
  grid-row: 40 / span 3;
}

/*******************************************************************************
Penrose
*******************************************************************************/

#penrose {
  --length: 84%;
  --step: calc(var(--length) / 5);
  --tan60: tan(60deg);

  --light: hsl(0, 0%, 85%);
  --medium: hsl(0, 0%, 55%);
  --dark: hsl(0, 0%, 40%);

  position: relative;
  padding-top: calc(var(--step) * 1.2);
  padding-left: calc(var(--step) * 0.4);
  aspect-ratio: 1 / 1;

  & div {
    position: absolute;
    width: 100%;
    aspect-ratio: 1 / 1;
    transform-origin: calc(var(--step) * 3) calc(var(--step) * 2);
    text-align: center;
    line-height: 2rem;

    clip-path: polygon(
      calc(var(--step) * 0.5) 0,
      calc(var(--step) * 5.5) 0,
      calc(var(--step) * 3.5) calc(var(--tan60) * (var(--step) * 2)),
      calc(var(--step) * 3) calc(var(--tan60) * (var(--step) * 1.5)),
      calc(var(--step) * 4) calc(var(--tan60) * (var(--step) * 0.5)),
      0 calc(var(--tan60) * var(--step) * 0.5)
    );

    &:nth-of-type(1) {
      transform: rotate(-40deg);
      background: linear-gradient(to top, var(--light) 60%, transparent);
      color: var(--medium);
    }
    &:nth-of-type(2) {
      transform: rotate(80deg);
      background: linear-gradient(to top, var(--medium) 60%, var(--light));
      color: var(--dark);
    }
    &:nth-of-type(3) {
      transform: rotate(200deg);
      background: linear-gradient(to top, var(--dark) 60%, var(--medium));
      color: var(--light);
    }
  }
}

/*******************************************************************************
Window
*******************************************************************************/

#window {
  --wall: 1.5rem;
  aspect-ratio: 1 / 2;
  border: 1px solid black;
  border-top-left-radius: 10rem;
  border-top-right-radius: 10rem;
  background: darkgrey;
  background-image: linear-gradient(337deg, #4040ff 6% 6%, #ffd713 100%);
  background-size: 400% 400%;
  animation: gradient 15s ease infinite;
  box-shadow: inset var(--wall) calc(var(--wall) * 0.6) 0 silver,
    inset calc(var(--wall) + 1px) calc(var(--wall) * 0.6 + 1px) 0 black;
}
@supports (color: color(display-p3 1 1 1)) {
  #window {
    background-image: linear-gradient(
      337deg in lch,
      color(display-p3 25% 25% 100%) 6% 6%,
      color(display-p3 100% 85% 30%) 100%
    );
  }
}

@keyframes gradient {
  0% {
    background-position: top;
  }
  25% {
    background-position: left;
  }
  50% {
    background-position: bottom;
  }
  75% {
    background-position: right;
  }
  100% {
    background-position: top;
  }
}

/*******************************************************************************
. __ _ _  _ ___| |_ ___ ___
/ _` | || / _ \  _/ -_|_-<
\__, |\_,_\___/\__\___/__/
****|_|************************************************************************/
blockquote {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background-image: radial-gradient(black 15%, transparent 16%), radial-gradient(black 15%, transparent 16%);
  background-size: 8px 8px;
  background-position: 0 0, 4px 4px;
  display: flex;
  flex-flow: column nowrap;
  justify-content: center;
}
blockquote p {
  margin: 0;
  background: var(--bgcolor);
  text-wrap: balance;
  font-size: 1.9rem;
}
blockquote p::before {
  content: '“';
}
blockquote p::after {
  content: '„';
}
blockquote cite {
  padding-top: 0.5rem;
  font-size: 1rem;
  white-space: nowrap;
  background: var(--bgcolor);
}

/*******************************************************************************
. __ ___ _ _  ______| |___ 
/ _/ _ \ ' \(_-< _ \ / -_)
\__\___/_||_/__|___/_\___|
*******************************************************************************/
section.console {
  position: relative;
  display: flex;
  flex-flow: column nowrap;
  border-radius: 1rem;
  flex-grow: 2;
}
section.console h2 {
  background: linear-gradient(to top, #ccc, #f5f5f5);
  color: #000;
  line-height: 1.4rem;
  font-size: 1rem;
  margin-bottom: 0;
  border-radius: 0.5rem 0.5rem 0 0;
  text-align: center;
}
section.console::before,
section.console::after {
  position: absolute;
  display: block;
  content: '';
  width: 0.7rem;
  height: 0.7rem;
  left: 0.4rem;
  top: 1.2rem;
  border-radius: 50%;
  z-index: 10;
}
section.console::before {
  background-color: red;
}
section.console::after {
  left: 1.4rem;
  background-color: orange;
}
section.console textarea {
  flex-grow: 2;
  background: var(--termcolor) !important;
  resize: none;
  padding: 0.2rem;
  color: var(--bgcolor);
  font-family: monospace;
  text-align: left;
  outline: none !important;
  border-radius: 0 0 0.5rem 0.5rem;
}
